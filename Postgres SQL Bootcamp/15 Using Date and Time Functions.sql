-- Using DATE and TIME functions

SHOW DateStyle;

SET DateStyle = 'ISO, MDY';

SHOW DateStyle;

SET DateStyle = 'ISO, DMY';

-- MAKE_DATE function

SELECT 
MAKE_DATE(2022, 12, 30);

-- MAKE-TIME function

SELECT
MAKE_TIME(12,30,15.55);

-- MAKE_TIMESTAMP function

SELECT
MAKE_TIMESTAMP(2002,11,03,06,12,12);

-- MAKE_INTERVAL function

SELECT 
MAKE_INTERVAL(1,1,1,1,1,1,1);

SELECT
MAKE_INTERVAL(years=>12, weeks=>3); -- this is more readable then above one


-- MAKE_TIMESTAMPTZ function

SELECT
MAKE_TIMESTAMPTZ(2002,11,03,06,12,12.12,'US/Alaska'); -- Output  "2002-11-03 20:42:12.12+05:30"

SELECT
MAKE_TIMESTAMPTZ(2025,2,07,14,50,49,'Asia/Calcutta'); -- Output "2002-11-03 20:42:12.12+05:30"

SELECT
MAKE_TIMESTAMPTZ(2002,11,03,18,12,12.12,'US/Alaska'); -- Output "2002-11-04 08:42:12.12+05:30"



-- EXTRACT Function

SELECT 
	CURRENT_TIMESTAMP,
	EXTRACT('DAY' FROM CURRENT_TIMESTAMP),
	EXTRACT('MONTH' FROM CURRENT_TIMESTAMP),
	EXTRACT('YEAR' FROM CURRENT_TIMESTAMP),
	EXTRACT('HOUR' FROM CURRENT_TIMESTAMP),
	EXTRACT('EPOCH' FROM CURRENT_TIMESTAMP);


-- Using math with date

SELECT
	TIME '20:25:30' + INTERVAL '10 MINUTES',
	TIME '20:25:30' + INTERVAL '10 HOURS';


SELECT 
	'20250207'::DATE + 20;


SELECT 
	CURRENT_TIMESTAMP,
	CURRENT_TIMESTAMP + '02:02:02';

SELECT 
	CURRENT_TIME,
	CURRENT_TIME(2),
	LOCALTIME,
	LOCALTIME(3),
	CURRENT_DATE,
	CURRENT_TIMESTAMP,
	LOCALTIMESTAMP;


SELECT
	NOW(),
	TRANSACTION_TIMESTAMP(),
	STATEMENT_TIMESTAMP(),
	TIMEOFDAY();


-- AGE Function

SELECT 
	AGE(CURRENT_DATE, '2002-11-03');



-- CURRENT_TIME and CURRENT_DATE Function

CREATE TABLE logs(
	log_id SERIAL PRIMARY KEY,
	add_date DATE DEFAULT CURRENT_DATE,
	add_time TIME DEFAULT CURRENT_TIME
);

INSERT INTO logs (log_id) VALUES (3);

SELECT *
FROM logs;


-- Accuracy with EPOCH

SELECT
	EXTRACT(EPOCH FROM AGE(CURRENT_TIMESTAMP, TIMESTAMP '2002-11-03')); 
	-- OUTPUT 702449067.617003

SELECT 
	EXTRACT(EPOCH FROM CURRENT_TIMESTAMP) - 
	EXTRACT(EPOCH FROM TIMESTAMP '2002-11-03');
	-- OUTPUT 702449048.920358


SELECT
	(EXTRACT(EPOCH FROM CURRENT_TIMESTAMP) - EXTRACT(EPOCH FROM TIMESTAMP '2002-11-03')) 
	/ 60 / 60 / 24 AS "EPOCH",
	EXTRACT(EPOCH FROM AGE(CURRENT_TIMESTAMP, TIMESTAMP '2002-11-03')) / 60 / 60 / 24 AS "AGE",
	CURRENT_TIMESTAMP - TIMESTAMP '2002-11-03' AS "TIMESTAMP";

-- HERE IN ABOVE EXAMPLE WE CAN CLEARLY SEE DIFFERENCE OF 2 DAYS IN ACCURACY BETWEEN EPOCH AND AGE
	

-- ALL TIMEZONE LIST

SELECT * FROM pg_timezone_names;f

SELECT * FROM pg_timezone_abbrevs;


-- date_trunc()

SELECT 
	date_trunc('month', release_date) AS "Release Month",
	COUNT(movie_id)
FROM 
	movies
GROUP BY
	"Release Month"
ORDER BY
 	1 DESC;